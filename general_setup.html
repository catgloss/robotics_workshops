<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working on the Vector Cluster (General Guide) &mdash; Robotics Workshops Cluster Guide  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Autonmous Navigation Workshop Cluster Guide" href="autonmous_navigation_workshop.html" />
    <link rel="prev" title="Robotics Workshops Cluster Guide" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Robotics Workshops Cluster Guide
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Working on the Vector Cluster (General Guide)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-access">Getting Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-logging-in">Step 1: Logging In</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-setting-up-mfa">Step 2: Setting up MFA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-changing-your-password">Step 3: Changing your password</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-finishing-setup">Step 4: Finishing Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#working-on-the-cluster">Working on the Cluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-a-job">Running a Job</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-emption-checkpointing">Pre-emption &amp; Checkpointing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-your-environment">Setting up your environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optional-vector-vpn">(Optional) Vector VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optional-vs-code-setup">(Optional) VS Code Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1">Step 1:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2">Step 2:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3">Step 3:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4">Step 4:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tips">Tips:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="autonmous_navigation_workshop.html">Autonmous Navigation Workshop Cluster Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="safe_learning_in_rl_workshop.html">Safe Learning in RL Workshop Cluster Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Robotics Workshops Cluster Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Working on the Vector Cluster (General Guide)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/general_setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="working-on-the-vector-cluster-general-guide">
<h1>Working on the Vector Cluster (General Guide)<a class="headerlink" href="#working-on-the-vector-cluster-general-guide" title="Permalink to this headline"></a></h1>
<p>This guide provides the general process for getting access to and running jobs on the vector cluster.</p>
<section id="getting-access">
<h2>Getting Access<a class="headerlink" href="#getting-access" title="Permalink to this headline"></a></h2>
<p>An account on the cluster has already been made for you. You will just need to be able to login to get started.</p>
<section id="step-1-logging-in">
<h3>Step 1: Logging In<a class="headerlink" href="#step-1-logging-in" title="Permalink to this headline"></a></h3>
<p>You will receive an email from Vector with your credentials for logging into the cluster. The cluster is accessed using ssh so you can directly use the Linux/MacOS terminal or Powershell for Windows. If you want to have a more accessible environment, using an IDE like VS code is recommended. A quick guide for setting up VS code can be found <a class="reference external" href="https://catgloss.github.io/robotics_workshops/general_setup.html#optional-vs-code-setup">here</a></p>
<p>Which ever method use choose from the above to login, the process is the same. First, ssh in.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh &lt;your username&gt;@&lt;x&gt;.vectorinstitute.ai
</pre></div>
</div>
<p>The x here refers to the different cluster domains available among q, v, and m. For these workshops, you can use &lt;x&gt;. toYou will be prompted for your password. Enter your password (provided in the email).</p>
</section>
<section id="step-2-setting-up-mfa">
<h3>Step 2: Setting up MFA<a class="headerlink" href="#step-2-setting-up-mfa" title="Permalink to this headline"></a></h3>
<p>After entering your password (correctly), you will be provided a link to enroll in DUO multi-factor authentication.</p>
<p>Install the DUO app on your iOS or Android device and scan the QR code given through the link to complete sign up.</p>
<p>When you login again, you can choose to get an SMS notif or directly get a passcode through the DUO app. You can also optionally setup the <a class="reference external" href="https://catgloss.github.io/robotics_workshops/general_setup.html#optional-vs-code-setup">Vector VPN</a>.</p>
</section>
<section id="step-3-changing-your-password">
<h3>Step 3: Changing your password<a class="headerlink" href="#step-3-changing-your-password" title="Permalink to this headline"></a></h3>
<p>Once you’ve successfully accessed the cluster after setting up DUO, you will need to change your password.</p>
<p>Enter the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>passwd
</pre></div>
</div>
<p>Change your password to something secure.</p>
</section>
<section id="step-4-finishing-setup">
<h3>Step 4: Finishing Setup<a class="headerlink" href="#step-4-finishing-setup" title="Permalink to this headline"></a></h3>
<p>You are automatically in your profile’s home directory. If you ever need to check which directory you are in, you can run the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<p>and your current directory will be spit out.</p>
</section>
</section>
<section id="working-on-the-cluster">
<h2>Working on the Cluster<a class="headerlink" href="#working-on-the-cluster" title="Permalink to this headline"></a></h2>
<section id="running-a-job">
<h3>Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline"></a></h3>
<p>For the purposes of these workshops, we have simplified the computing guide provided through <a class="reference external" href="https://support.vectorinstitute.ai/Computing">Vector</a> (which you will have access to once your account is setup).</p>
<ul class="simple">
<li><p>In order to run jobs on the Vector cluster, you need to submit a job on SLURM scheduler. To do so, you need to create a shell script (e.g. <code class="docutils literal notranslate"><span class="pre">job.sh</span></code>) and submit the job. This is how the job will be submitted.</p></li>
</ul>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch job.sh
</pre></div>
</div>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">job.sh</span></code> file defines the parameters for your job. The defaults defined below should be good.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --job-name=any_name_here</span>

<span class="c1">#SBATCH --partition=p100,t4v1,t4v2,rtx6000</span>

<span class="c1">#SBATCH --gres=gpu:1</span>

<span class="c1">#SBATCH --qos=normal</span>

<span class="c1">#SBATCH --cpus-per-task=4</span>

<span class="c1">#SBATCH --mem-per-cpu=8G</span>

<span class="c1">#SBATCH --output=slurm-%j.out</span>

<span class="c1">#SBATCH --error=slurm-%j.err</span>

<span class="c1"># prepare your environment here</span>
module load pytorch1.7.1-cuda11.0-python3.6

<span class="c1"># put your command here</span>
python train.py
</pre></div>
</div>
<p>sbatch will execute your job in the background. If you are looking to run an interactive job to debug, instead run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun -c <span class="m">4</span> --gres<span class="o">=</span>gpu:1 --mem<span class="o">=</span>32GB --qos<span class="o">=</span>nopreemption -p interactive --pty bash
</pre></div>
</div>
<p>This will tell SLURM you want 4 CPUs(-c 4), 1 GPU(–gres=gpu:1), 32GB of CPU ram(–mem) on nopreemption QOS and on the interactive partition(-p) and then launch bash(–pty bash). Note that there is a limit of 3 hours before SLURM will cancel your interactive job.</p>
<p>To check the status of your job in the queue:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>squeue -u <span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Finally, to cancel a job</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scancel JOBID
</pre></div>
</div>
<p>To test if everything is setup correctly, you can create a test script using the above default script with your own commands make sure the job is scheduled, you can see it queued and running, and can cancel it then you’re good to go with continuing your development.</p>
</section>
<section id="pre-emption-checkpointing">
<h3>Pre-emption &amp; Checkpointing<a class="headerlink" href="#pre-emption-checkpointing" title="Permalink to this headline"></a></h3>
<p>To ensure fair allocation of the cluster resources, every hour, your job is evaluated for pre-emption, meaning that it may be stopped. To ensure you don’t lose your progress, it is important to write checkpoints for your models. <code class="docutils literal notranslate"><span class="pre">/checkpoint/YOURUSERID</span></code> should be the location you write these checkpoints to as it runs on a different kind of file system called MooseFS, which is great for storing a small amount of large files, like model checkpoints.</p>
<p>When you actually run a job, a folder to store that jobs checkpoints will be created called /checkpoint/YOURUSERID/YOURJOBID. This can be used in your code to load in a previous checkpoint when the job continues.</p>
<p>For more information on checkpointing on the cluster, use <a class="reference external" href="https://support.vectorinstitute.ai/CheckpointExample">Vector’s Checkpoint Example</a></p>
</section>
<section id="setting-up-your-environment">
<h3>Setting up your environment<a class="headerlink" href="#setting-up-your-environment" title="Permalink to this headline"></a></h3>
<p>To view existing environments on the cluster, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module av
</pre></div>
</div>
<p>To load an existing environment, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load ENV_YOU_WANT_TO_LOAD
</pre></div>
</div>
<p>If an environment doesn’t exist, create your own with venv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 -m venv some_env
</pre></div>
</div>
<p>and activate the environment with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> &lt;some_env&gt;/bin/activate
</pre></div>
</div>
<p>To deactivate, just execute <cite>deactivate</cite> in the command line.</p>
</section>
</section>
<section id="optional-vector-vpn">
<h2>(Optional) Vector VPN<a class="headerlink" href="#optional-vector-vpn" title="Permalink to this headline"></a></h2>
<p>The Vector VPN can be used to create an extra layer of security. Specifically, it can be used if you want to work on Jupyter Notebooks but have it be run on the cluster.</p>
<p>To set up the VPN</p>
</section>
<section id="optional-vs-code-setup">
<h2>(Optional) VS Code Setup<a class="headerlink" href="#optional-vs-code-setup" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://code.visualstudio.com/">Visual Studio (VS) Code</a> is a great IDE that makes working on remote connections easy. It also provides other tools like <a class="reference external" href="https://code.visualstudio.com/docs/editor/intellisense#:~:text=IntelliSense%20is%20a%20general%20term,%2C%20and%20%22code%20hinting.%22">Intellisense</a> that makes development easy.</p>
<p>If you don’t already use it, it will make working on files on the cluster easier while you are debugging. Here is how it can be set up for use on the cluster:</p>
<section id="step-1">
<h3>Step 1:<a class="headerlink" href="#step-1" title="Permalink to this headline"></a></h3>
<p>Download the IDE from this <a class="reference external" href="https://code.visualstudio.com/Download">link</a> for which ever operating system you are using.</p>
</section>
<section id="step-2">
<h3>Step 2:<a class="headerlink" href="#step-2" title="Permalink to this headline"></a></h3>
<p>Open up VS code and install the Remote Development extension pack. To do this, click the extensions icon (group of 4 blocks) on the left hand side of the screen and search ‘remote’. The package ‘Remote - SSH’ should pop up. Install it.</p>
<a class="reference internal image-reference" href="_images/vscode_img.png"><img alt="alternate text" class="align-right" src="_images/vscode_img.png" style="width: 477.0px; height: 310.0px;" /></a>
</section>
<section id="step-3">
<h3>Step 3:<a class="headerlink" href="#step-3" title="Permalink to this headline"></a></h3>
<p>VS code can be used to save ssh configurations to make connecting easier. To get started with a connection, either press ctrl+p or click the gear at the bottom left hand side. This will open up the command palette where you can type ‘remote’ and select the option to add a new ssh host. The other option is to directly click the little arrow icon at the bottom left hand side which will ask you to select if you want to connect to a host or add a new host (the last option). Click latter option.</p>
</section>
<section id="step-4">
<h3>Step 4:<a class="headerlink" href="#step-4" title="Permalink to this headline"></a></h3>
<p>In all cases, you will now be able to type in command for the host you want to connect to. In our case, it is the same as was shown above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh &lt;your username&gt;@&lt;x&gt;.vectorinstitute.ai
</pre></div>
</div>
<p>You can use the same process that was followed above to log in. Open the terminal by clicking Terminal-&gt;New Terminal at the top of your screen. Now you can open any files on the cluster by typing code &lt;your file&gt; in the command line and editing like you would any other IDE.</p>
</section>
<section id="tips">
<h3>Tips:<a class="headerlink" href="#tips" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>It’s nice to be able to see the layout of your workspace all at once. You can open up a directory in your workspace by going to File-&gt;Open Folder and you will be able to see all your files laid out in explorer tab. As you go through files in the IDE, it will bring you to that location in your workspace.</p></li>
<li><p>You can easily find files in your workspace and open them up by pressing ctrl+p and typing in the approximate name of your file. You can select it from the list and easily open it up.</p></li>
<li><p>You can install <a class="reference external" href="https://code.visualstudio.com/docs/editor/intellisense#:~:text=IntelliSense%20is%20a%20general%20term,%2C%20and%20%22code%20hinting.%22">Intellisense</a> for whatever language you are working in that will make it easy to navigate and understand code. To install, click the extensions icon on the left hand on the left hand side, search ‘intellisense’ and your language of choice and click install. You may need to restart your session for intellisense to become active.</p></li>
<li><p>Take a look through the other extensions for anything that might be useful to you! There is lots of different ones that can be very helpful depending on what you are working on.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Robotics Workshops Cluster Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="autonmous_navigation_workshop.html" class="btn btn-neutral float-right" title="Autonmous Navigation Workshop Cluster Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Vector AI Engineering.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>